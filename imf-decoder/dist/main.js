(()=>{"use strict";var e={413:(e,t,n)=>{e.exports=n.p+"c27330a6f5e4659ecfb3.wasm"},218:(e,t,n)=>{let r;function o(e){return null==e}n.r(t),n.d(t,{IMFDecoder:()=>A,Tensor:()=>k,default:()=>W,initSync:()=>x,start:()=>S});let s=null;function i(){return(null===s||!0===s.buffer.detached||void 0===s.buffer.detached&&s.buffer!==r.memory.buffer)&&(s=new DataView(r.memory.buffer)),s}const c="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&c.decode();let a=null;function l(){return null!==a&&0!==a.byteLength||(a=new Uint8Array(r.memory.buffer)),a}function _(e,t){return e>>>=0,c.decode(l().subarray(e,e+t))}let d=0;const u="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},f="function"==typeof u.encodeInto?function(e,t){return u.encodeInto(e,t)}:function(e,t){const n=u.encode(e);return t.set(n),{read:e.length,written:n.length}};function g(e,t,n){if(void 0===n){const n=u.encode(e),r=t(n.length,1)>>>0;return l().subarray(r,r+n.length).set(n),d=n.length,r}let r=e.length,o=t(r,1)>>>0;const s=l();let i=0;for(;i<r;i++){const t=e.charCodeAt(i);if(t>127)break;s[o+i]=t}if(i!==r){0!==i&&(e=e.slice(i)),o=n(o,r,r=i+3*e.length,1)>>>0;const t=l().subarray(o+i,o+r);i+=f(e,t).written,o=n(o,r,i,1)>>>0}return d=i,o}function b(e){const t=typeof e;if("number"==t||"boolean"==t||null==e)return`${e}`;if("string"==t)return`"${e}"`;if("symbol"==t){const t=e.description;return null==t?"Symbol":`Symbol(${t})`}if("function"==t){const t=e.name;return"string"==typeof t&&t.length>0?`Function(${t})`:"Function"}if(Array.isArray(e)){const t=e.length;let n="[";t>0&&(n+=b(e[0]));for(let r=1;r<t;r++)n+=", "+b(e[r]);return n+="]",n}const n=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(!(n.length>1))return toString.call(e);if(r=n[1],"Object"==r)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:r}let w=null;function h(){return null!==w&&0!==w.byteLength||(w=new Float32Array(r.memory.buffer)),w}let y=null;function p(e,t){const n=t(4*e.length,4)>>>0;return(null!==y&&0!==y.byteLength||(y=new Uint32Array(r.memory.buffer)),y).set(e,n/4),d=e.length,n}function m(e){const t=r.__wbindgen_export_2.get(e);return r.__externref_table_dealloc(e),t}function S(){r.start()}function I(e){const t=r.__externref_table_alloc();return r.__wbindgen_export_2.set(t,e),t}function v(e,t){try{return e.apply(this,t)}catch(e){const t=I(e);r.__wbindgen_exn_store(t)}}const E="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_imfdecoder_free(e>>>0,1)));class A{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,E.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_imfdecoder_free(e,0)}constructor(e,t){const n=r.imfdecoder_new(e,t);if(n[2])throw m(n[1]);return this.__wbg_ptr=n[0]>>>0,E.register(this,this.__wbg_ptr,this),this}test(){let e,t;try{const n=r.imfdecoder_test(this.__wbg_ptr);return e=n[0],t=n[1],_(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}get diagnostic_mode(){return 0!==r.imfdecoder_diagnostic_mode(this.__wbg_ptr)}set diagnostic_mode(e){r.imfdecoder_set_diagnostic_mode(this.__wbg_ptr,e)}set_reference_data(e){let t,n;try{const i=r.imfdecoder_set_reference_data(this.__wbg_ptr,e);var o=i[0],s=i[1];if(i[3])throw o=0,s=0,m(i[2]);return t=o,n=s,_(o,s)}finally{r.__wbindgen_free(t,n,1)}}process_tokens(e){let t,n;try{const i=r.imfdecoder_process_tokens(this.__wbg_ptr,e);var o=i[0],s=i[1];if(i[3])throw o=0,s=0,m(i[2]);return t=o,n=s,_(o,s)}finally{r.__wbindgen_free(t,n,1)}}process_batch(){let e,t;try{const s=r.imfdecoder_process_batch(this.__wbg_ptr);var n=s[0],o=s[1];if(s[3])throw n=0,o=0,m(s[2]);return e=n,t=o,_(n,o)}finally{r.__wbindgen_free(e,t,1)}}get_reference_status(){let e,t;try{const n=r.imfdecoder_get_reference_status(this.__wbg_ptr);return e=n[0],t=n[1],_(n[0],n[1])}finally{r.__wbindgen_free(e,t,1)}}}const D="undefined"==typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry((e=>r.__wbg_tensor_free(e>>>0,1)));class k{__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,D.unregister(this),e}free(){const e=this.__destroy_into_raw();r.__wbg_tensor_free(e,0)}constructor(e,t){const n=function(e,t){const n=t(4*e.length,4)>>>0;return h().set(e,n/4),d=e.length,n}(e,r.__wbindgen_malloc),o=d,s=p(t,r.__wbindgen_malloc),i=d,c=r.tensor_new(n,o,s,i);return this.__wbg_ptr=c>>>0,D.register(this,this.__wbg_ptr,this),this}reshape(e){const t=p(e,r.__wbindgen_malloc),n=d;r.tensor_reshape(this.__wbg_ptr,t,n)}get_data(){const e=r.tensor_get_data(this.__wbg_ptr);var t,n,o=(t=e[0],n=e[1],t>>>=0,h().subarray(t/4,t/4+n)).slice();return r.__wbindgen_free(e[0],4*e[1],4),o}}function F(){const e={};return e.wbg={},e.wbg.__wbindgen_number_get=function(e,t){const n="number"==typeof t?t:void 0;i().setFloat64(e+8,o(n)?0:n,!0),i().setInt32(e+0,!o(n),!0)},e.wbg.__wbindgen_error_new=function(e,t){return new Error(_(e,t))},e.wbg.__wbindgen_is_bigint=function(e){return"bigint"==typeof e},e.wbg.__wbindgen_bigint_from_u64=function(e){return BigInt.asUintN(64,e)},e.wbg.__wbindgen_jsval_eq=function(e,t){return e===t},e.wbg.__wbindgen_is_object=function(e){return"object"==typeof e&&null!==e},e.wbg.__wbindgen_is_undefined=function(e){return void 0===e},e.wbg.__wbindgen_in=function(e,t){return e in t},e.wbg.__wbindgen_string_new=function(e,t){return _(e,t)},e.wbg.__wbindgen_boolean_get=function(e){return"boolean"==typeof e?e?1:0:2},e.wbg.__wbindgen_jsval_loose_eq=function(e,t){return e==t},e.wbg.__wbindgen_string_get=function(e,t){const n="string"==typeof t?t:void 0;var s=o(n)?0:g(n,r.__wbindgen_malloc,r.__wbindgen_realloc),c=d;i().setInt32(e+4,c,!0),i().setInt32(e+0,s,!0)},e.wbg.__wbg_String_91fba7ded13ba54c=function(e,t){const n=g(String(t),r.__wbindgen_malloc,r.__wbindgen_realloc),o=d;i().setInt32(e+4,o,!0),i().setInt32(e+0,n,!0)},e.wbg.__wbg_getwithrefkey_15c62c2b8546208d=function(e,t){return e[t]},e.wbg.__wbg_new_abda76e883ba8a5f=function(){return new Error},e.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const n=g(t.stack,r.__wbindgen_malloc,r.__wbindgen_realloc),o=d;i().setInt32(e+4,o,!0),i().setInt32(e+0,n,!0)},e.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let n,o;try{n=e,o=t,console.error(_(e,t))}finally{r.__wbindgen_free(n,o,1)}},e.wbg.__wbg_instanceof_Window_6575cd7f1322f82f=function(e){let t;try{t=e instanceof Window}catch(e){t=!1}return t},e.wbg.__wbg_createElement_e4523490bd0ae51d=function(){return v((function(e,t,n){return e.createElement(_(t,n))}),arguments)},e.wbg.__wbg_instanceof_HtmlCanvasElement_022ad88c76df9031=function(e){let t;try{t=e instanceof HTMLCanvasElement}catch(e){t=!1}return t},e.wbg.__wbg_getContext_bf8985355a4d22ca=function(){return v((function(e,t,n){const r=e.getContext(_(t,n));return o(r)?0:I(r)}),arguments)},e.wbg.__wbg_now_d3cbc9581625f686=function(e){return e.now()},e.wbg.__wbg_instanceof_WebGl2RenderingContext_8dbe5170d8fdea28=function(e){let t;try{t=e instanceof WebGL2RenderingContext}catch(e){t=!1}return t},e.wbg.__wbg_attachShader_299671ccaa78592c=function(e,t,n){e.attachShader(t,n)},e.wbg.__wbg_compileShader_9680f4f1d833586c=function(e,t){e.compileShader(t)},e.wbg.__wbg_createProgram_48b8a105fd0cfb35=function(e){const t=e.createProgram();return o(t)?0:I(t)},e.wbg.__wbg_createShader_f956a5ec67a77964=function(e,t){const n=e.createShader(t>>>0);return o(n)?0:I(n)},e.wbg.__wbg_getProgramInfoLog_16c69289b6a9c98e=function(e,t,n){const s=t.getProgramInfoLog(n);var c=o(s)?0:g(s,r.__wbindgen_malloc,r.__wbindgen_realloc),a=d;i().setInt32(e+4,a,!0),i().setInt32(e+0,c,!0)},e.wbg.__wbg_getProgramParameter_4c981ddc3b62dda8=function(e,t,n){return e.getProgramParameter(t,n>>>0)},e.wbg.__wbg_getShaderInfoLog_afb2baaac4baaff5=function(e,t,n){const s=t.getShaderInfoLog(n);var c=o(s)?0:g(s,r.__wbindgen_malloc,r.__wbindgen_realloc),a=d;i().setInt32(e+4,a,!0),i().setInt32(e+0,c,!0)},e.wbg.__wbg_getShaderParameter_e21fb00f8255b86b=function(e,t,n){return e.getShaderParameter(t,n>>>0)},e.wbg.__wbg_linkProgram_983c5972b815b0de=function(e,t){e.linkProgram(t)},e.wbg.__wbg_shaderSource_c36f18b5114855e7=function(e,t,n,r){e.shaderSource(t,_(n,r))},e.wbg.__wbg_document_d7fa2c739c2b191a=function(e){const t=e.document;return o(t)?0:I(t)},e.wbg.__wbg_performance_8efa15a3e0d18099=function(e){const t=e.performance;return o(t)?0:I(t)},e.wbg.__wbg_log_f740dc2253ea759b="function"==typeof console.log?console.log:()=>{throw new Error("console.log is not defined")},e.wbg.__wbg_self_bf91bf94d9e04084=function(){return v((function(){return self.self}),arguments)},e.wbg.__wbg_window_52dd9f07d03fd5f8=function(){return v((function(){return window.window}),arguments)},e.wbg.__wbg_globalThis_05c129bf37fcf1be=function(){return v((function(){return globalThis.globalThis}),arguments)},e.wbg.__wbg_global_3eca19bb09e9c484=function(){return v((function(){return global.global}),arguments)},e.wbg.__wbg_newnoargs_1ede4bf2ebbaaf43=function(e,t){return new Function(_(e,t))},e.wbg.__wbg_call_a9ef466721e824f2=function(){return v((function(e,t){return e.call(t)}),arguments)},e.wbg.__wbg_get_5419cf6b954aa11d=function(e,t){return e[t>>>0]},e.wbg.__wbg_length_f217bbbf7e8e4df4=function(e){return e.length},e.wbg.__wbindgen_is_function=function(e){return"function"==typeof e},e.wbg.__wbg_next_13b477da1eaa3897=function(e){return e.next},e.wbg.__wbg_next_b06e115d1b01e10b=function(){return v((function(e){return e.next()}),arguments)},e.wbg.__wbg_done_983b5ffcaec8c583=function(e){return e.done},e.wbg.__wbg_value_2ab8a198c834c26a=function(e){return e.value},e.wbg.__wbg_iterator_695d699a44d6234c=function(){return Symbol.iterator},e.wbg.__wbg_get_ef828680c64da212=function(){return v((function(e,t){return Reflect.get(e,t)}),arguments)},e.wbg.__wbg_isArray_6f3b47f09adb61b5=function(e){return Array.isArray(e)},e.wbg.__wbg_instanceof_ArrayBuffer_74945570b4a62ec7=function(e){let t;try{t=e instanceof ArrayBuffer}catch(e){t=!1}return t},e.wbg.__wbg_isSafeInteger_b9dff570f01a9100=function(e){return Number.isSafeInteger(e)},e.wbg.__wbg_buffer_ccaed51a635d8a2d=function(e){return e.buffer},e.wbg.__wbg_new_fec2611eb9180f95=function(e){return new Uint8Array(e)},e.wbg.__wbg_set_ec2fcf81bc573fd9=function(e,t,n){e.set(t,n>>>0)},e.wbg.__wbg_length_9254c4bd3b9f23c4=function(e){return e.length},e.wbg.__wbg_instanceof_Uint8Array_df0761410414ef36=function(e){let t;try{t=e instanceof Uint8Array}catch(e){t=!1}return t},e.wbg.__wbindgen_bigint_get_as_i64=function(e,t){const n="bigint"==typeof t?t:void 0;i().setBigInt64(e+8,o(n)?BigInt(0):n,!0),i().setInt32(e+0,!o(n),!0)},e.wbg.__wbindgen_debug_string=function(e,t){const n=g(b(t),r.__wbindgen_malloc,r.__wbindgen_realloc),o=d;i().setInt32(e+4,o,!0),i().setInt32(e+0,n,!0)},e.wbg.__wbindgen_throw=function(e,t){throw new Error(_(e,t))},e.wbg.__wbindgen_memory=function(){return r.memory},e.wbg.__wbindgen_init_externref_table=function(){const e=r.__wbindgen_export_2,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},e}function P(e,t){return r=e.exports,M.__wbindgen_wasm_module=t,s=null,w=null,y=null,a=null,r.__wbindgen_start(),r}function x(e){if(void 0!==r)return r;void 0!==e&&(Object.getPrototypeOf(e)===Object.prototype?({module:e}=e):console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));const t=F();return e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e)),P(new WebAssembly.Instance(e,t),e)}async function M(e){if(void 0!==r)return r;void 0!==e&&(Object.getPrototypeOf(e)===Object.prototype?({module_or_path:e}=e):console.warn("using deprecated parameters for the initialization function; pass a single object instead")),void 0===e&&(e=new URL(n(413),n.b));const t=F();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:o,module:s}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return P(o,s)}const W=M}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.b=document.baseURI||self.location.href;var r,o,s,i=n(218);async function c(){console.log("🔍 Starting WASM verification...");try{await(0,i.default)();const e=Object.keys(await Promise.resolve().then(n.bind(n,218)));console.log("📦 WASM Exports:",e);const t=640,r=480;console.log(`Creating new IMF decoder with dimensions ${t}x${r}`);const o=new i.IMFDecoder(t,r),s=Object.getOwnPropertyNames(i.IMFDecoder.prototype);console.log("🔧 IMFDecoder Methods:",s);const c=o.test();if(console.log("🧪 Test method output:",c),console.log("IMFDecoder instance:",o),!c.includes("IMFDecoder working!"))throw new Error("Decoder test failed");return console.log("✅ WASM verification successful!"),{success:!0,decoder:o}}catch(e){return console.error("❌ WASM verification failed:",e),{success:!1,error:e instanceof Error?e:new Error("Unknown error")}}}async function a(){try{console.log("🔍 Starting WASM verification...");const{success:e,module:t,decoder:n,error:r}=await c();if(!e||!n)return console.error("Failed to initialize decoder:",r),void(r?.stack&&console.error("Stack:",r.stack));console.log("IMFDecoder instance:",n),console.log("✅ WASM verification successful!"),window.decoder=n,window.wasm=t,await async function(e){try{console.log("Available methods:",Object.getOwnPropertyNames(i.IMFDecoder.prototype));const t=e.test();if(console.log("Initial test:",t),console.log("Setting diagnostic mode..."),e.diagnostic_mode=!0,console.log("Diagnostic mode set to:",e.diagnostic_mode),!e.diagnostic_mode)throw new Error("Failed to set diagnostic mode");console.log("Diagnostic mode is now:",e.diagnostic_mode),console.log("Setting reference data...");const n={features:[{tensor:new Float32Array(524288).fill(.5),shape:[1,128,64,64]},{tensor:new Float32Array(262144).fill(.5),shape:[1,256,32,32]},{tensor:new Float32Array(131072).fill(.5),shape:[1,512,16,16]},{tensor:new Float32Array(32768).fill(.5),shape:[1,512,8,8]}],token:new Float32Array(32).fill(.1)},r=await e.set_reference_data(n);console.log("Set reference data result:",r),console.log("Processing tokens...");const o=new Float32Array(1228800).fill(.5);if("function"!=typeof e.process_tokens)throw new Error("process_tokens method not found on decoder");return console.log("process_tokens exists:",typeof e.process_tokens),await e.process_tokens([{token:o,frame_index:0}]),await e.process_batch(),{success:!0,message:"All decoder tests completed successfully"}}catch(e){return console.error("Error processing tokens:",e),console.error("Stack:",e),console.error("Test sequence failed:",e),{success:!1,error:e instanceof Error?e.message:String(e)}}}(n),console.log("IMFDecoder initialized successfully")}catch(e){console.error("Failed to initialize decoder:",e),e instanceof Error&&console.error("Stack:",e.stack);try{const e=await Promise.resolve().then(n.bind(n,218));await(0,i.default)(),console.log("📦 WASM Exports:",Object.keys(e))}catch(e){console.error("Failed to import WASM module:",e)}}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",a):a(),function(e){e[e.Idle=0]="Idle",e[e.Ready=1]="Ready",e[e.Playing=2]="Playing",e[e.Pause=3]="Pause",e[e.Destroyed=4]="Destroyed"}(r||(r={})),function(e){e[e.Idle=0]="Idle",e[e.Initializing=1]="Initializing",e[e.Ready=2]="Ready",e[e.Open=3]="Open",e[e.Pause=4]="Pause",e[e.Closed=5]="Closed"}(o||(o={})),function(e){e.DecoderCreated="DecoderCreated",e.DecoderInit="DecoderInit",e.DecoderInited="DecoderInited",e.WasmLoaded="WasmLoaded",e.DecoderReady="DecoderReady",e.ReferenceDataSet="ReferenceDataSet",e.TokensProcessed="TokensProcessed",e.BatchProcessed="BatchProcessed",e.Error="Error"}(s||(s={}));class l{constructor(){this.decoder=null,this.playerStatus=r.Idle,this.decoderStatus=o.Idle,this.initializeElements(),this.setupEventListeners(),this.interceptConsole()}initializeElements(){const e=document.getElementById("verifyWasm"),t=document.getElementById("initDecoder"),n=document.getElementById("startDecoder"),r=document.getElementById("processFrame"),o=document.getElementById("pauseDecoder"),s=document.getElementById("clearLog"),i=document.getElementById("player-status"),c=document.getElementById("decoder-status");if(!(e&&t&&n&&r&&o&&s&&i&&c))throw new Error("Required DOM elements not found");this.buttons={verify:e,init:t,start:n,process:r,pause:o,clear:s},this.statusElements={player:i,decoder:c}}interceptConsole(){const e=console.log,t=console.error,n=console.warn;console.log=(...t)=>{this.log("info",...t),e.apply(console,t)},console.error=(...e)=>{this.log("error",...e),t.apply(console,e)},console.warn=(...e)=>{this.log("info",...e),n.apply(console,e)}}setupEventListeners(){this.buttons.verify.onclick=()=>this.verifyWasm(),this.buttons.init.onclick=()=>this.initializeDecoder(),this.buttons.start.onclick=()=>this.startDecoder(),this.buttons.process.onclick=()=>this.processFrame(),this.buttons.pause.onclick=()=>this.pauseDecoder(),this.buttons.clear.onclick=()=>this.clearLog()}updateStatus(e,t){const n=this.statusElements[e],s=("player"===e?r:o)[t];switch(n.className="status-value",t){case 0:n.classList.add("status-idle");break;case 1:n.classList.add("status-ready");break;case 2:n.classList.add("status-playing");break;case 3:n.classList.add("status-paused");break;default:n.classList.add("status-error")}n.textContent=s}async verifyWasm(){try{this.buttons.verify.disabled=!0,this.log("info","Verifying WASM...");const e=await c();e.success&&e.decoder?(this.decoder=e.decoder,this.buttons.init.disabled=!1,this.updateStatus("player",r.Ready),this.log("success","WASM verification successful!")):(this.updateStatus("player",r.Idle),this.log("error","WASM verification failed!"))}catch(e){this.log("error",`Error: ${e.message}`),this.updateStatus("player",r.Idle)}finally{this.buttons.verify.disabled=!1}}async initializeDecoder(){try{if(this.buttons.init.disabled=!0,this.updateStatus("decoder",o.Initializing),!this.decoder)throw new Error("Decoder not initialized");const e=this.createReferenceData();await this.decoder.set_reference_data(e),this.buttons.start.disabled=!1,this.updateStatus("decoder",o.Ready),this.log("success","Decoder initialized successfully")}catch(e){this.log("error",`Initialization error: ${e.message}`),this.updateStatus("decoder",o.Idle)}}async startDecoder(){try{this.buttons.start.disabled=!0,this.updateStatus("decoder",o.Open),this.buttons.process.disabled=!1,this.buttons.pause.disabled=!1,this.log("success","Decoder started")}catch(e){this.log("error",`Start error: ${e.message}`),this.updateStatus("decoder",o.Ready)}}async processFrame(){if(this.decoder)try{const e=640,t=480,n={token:new Float32Array(e*t*4).fill(.5),frame_index:0};this.log("info",`Processing frame with size: ${e}x${t}`),await this.decoder.process_tokens([n]);const r=await this.decoder.process_batch();this.log("success",`Frame processed: ${r}`)}catch(e){const t=e instanceof Error?e.message:String(e);this.log("error",`Process error: ${t}`)}}async pauseDecoder(){try{this.updateStatus("decoder",o.Pause),this.buttons.process.disabled=!0,this.buttons.pause.disabled=!0,this.buttons.start.disabled=!1,this.log("info","Decoder paused")}catch(e){this.log("error",`Pause error: ${e.message}`)}}createReferenceData(){return{features:[{tensor:new Float32Array(524288).fill(.5),shape:[1,128,64,64]},{tensor:new Float32Array(262144).fill(.5),shape:[1,256,32,32]},{tensor:new Float32Array(131072).fill(.5),shape:[1,512,16,16]},{tensor:new Float32Array(32768).fill(.5),shape:[1,512,8,8]}],token:new Float32Array(32).fill(.1)}}log(e,...t){const n=document.getElementById("log"),r=document.createElement("div");r.className=e,r.textContent=t.map((e=>"object"==typeof e?JSON.stringify(e):String(e))).join(" "),n.appendChild(r),n.scrollTop=n.scrollHeight}clearLog(){document.getElementById("log").innerHTML=""}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>new l)):new l})();